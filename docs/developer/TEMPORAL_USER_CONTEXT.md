# Temporal and User Context Enhancement

## Overview

As of version 4.0.33+, Claude MPM includes enhanced temporal and user context injection in the framework instructions. This provides the PM (Project Manager) agent with rich contextual information about the current datetime, user, and system environment.

## Features

### Enhanced Temporal Context
- **Full DateTime**: Complete date and time in 24-hour format (e.g., "2025-08-26 14:30:45")
- **Timezone Information**: Timezone name with UTC offset (e.g., "PST (UTC-08:00)")
- **Day of Week**: Current day name (e.g., "Monday")

### User Personalization
- **User Identification**: Current OS username with multiple fallback detection methods
- **Home Directory**: User's home directory path
- **Working Directory**: Current working directory

### System Information
- **Platform**: Operating system with friendly name (e.g., "Darwin (macOS)")
- **System Version**: OS version/release information
- **Locale**: System locale settings when available

## Implementation

The enhanced context is generated by the `_generate_temporal_user_context()` method in `FrameworkLoader` and automatically injected into PM instructions.

### Code Location
- **File**: `/src/claude_mpm/core/framework_loader.py`
- **Method**: `_generate_temporal_user_context()`
- **Injection Point**: Line ~999 in `get_framework_instructions()`

### Example Output

```markdown
## Temporal & User Context
**Current DateTime**: 2025-08-26 14:30:45 PST (UTC-08:00)
**Day**: Monday
**User**: masa
**Home Directory**: /Users/masa
**System**: Darwin (macOS)
**System Version**: 24.5.0
**Working Directory**: /Users/masa/Projects/claude-mpm
**Locale**: en_US

Apply temporal and user awareness to all tasks, decisions, and interactions.
Use this context for personalized responses and time-sensitive operations.
```

## Benefits

1. **Time-Aware Responses**: PM can make decisions based on current time, handle scheduling, and understand temporal context
2. **Personalized Interactions**: User identification enables personalized greetings and context-aware responses
3. **System-Aware Operations**: Understanding the platform helps with OS-specific recommendations
4. **Locale Awareness**: Proper formatting and localization based on system settings

## Error Handling

The implementation uses robust error handling with graceful fallbacks:
- If timezone detection fails, shows "Local Time"
- If user detection fails, that field is omitted
- If any component fails, the basic date is still provided
- All errors are logged at debug level without breaking functionality

## Backward Compatibility

This enhancement maintains full backward compatibility:
- Replaces the simple "Today's Date" with richer context
- Falls back to basic date format if enhanced generation fails
- Does not break any existing functionality
- Compatible with all Claude Code versions

## Testing

Test the feature using:
```bash
python tests/test_temporal_user_context.py
```

Or verify manually:
```python
from claude_mpm.core.framework_loader import FrameworkLoader
loader = FrameworkLoader()
context = loader._generate_temporal_user_context()
print(context)
```

## Future Enhancements

Potential future improvements could include:
- Weather information integration
- Calendar integration for meeting awareness
- Project-specific context (git branch, last commit, etc.)
- Team member information for collaborative projects
- Custom context extensions via plugins