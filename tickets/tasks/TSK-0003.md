---
actual_hours: null
assignees: []
created_at: '2026-02-08T21:17:32.515466'
dependencies: []
description: 'Bulk event creation, calendar export, multi-calendar operations.


  Acceptance Criteria:

  - [x] claude-mpm tools google calendar-bulk-create works

  - [x] claude-mpm tools google calendar-export works

  - [x] Handles event conflicts gracefully'
due_date: null
estimated_hours: null
id: TSK-0003
labels: []
metadata:
  epic: EP-0002
parent: null
priority: medium
status: completed
tags:
- ep-0002
- google
- calendar
title: Implement Calendar bulk operations tools
updated_at: '2026-02-08T02:57:41'
---

# Implement Calendar bulk operations tools

## Description
Bulk event creation, calendar export, multi-calendar operations.

Acceptance Criteria:
- [x] claude-mpm tools google calendar-bulk-create works
- [x] claude-mpm tools google calendar-export works
- [x] Handles event conflicts gracefully

## Details
- **Status**: completed
- **Priority**: medium
- **Assignees**: None
- **Tags**: ep-0002, google, calendar
- **Created**: 2026-02-08 21:17:32
- **Updated**: 2026-02-08 02:57:41
- **Completed**: 2026-02-08 02:57:41

## Implementation

**Commit**: 70c7e43e5

### Calendar Export (calendar-export)
- Exports events from Google Calendar with filtering
- Time range filtering via `--time-min` and `--time-max` (ISO 8601 format)
- Calendar selection via `--calendar-id` (default: "primary")
- Pagination support for large event sets (up to 250 per page)
- Configurable `--max-results` parameter
- Returns complete event details: id, summary, description, start/end times, location, attendees, html_link, status

**Usage**:
```bash
# Export upcoming events
claude-mpm tools google calendar-export --time-min "2026-02-01T00:00:00Z" --max-results 100

# Export from specific calendar
claude-mpm tools google calendar-export --calendar-id "team@example.com" --time-min "2026-02-01T00:00:00Z" --time-max "2026-03-01T00:00:00Z"
```

### Calendar Bulk Create (calendar-bulk-create)
- Creates multiple events from JSON file
- Validates required fields (summary, start_time, end_time)
- Supports optional fields: description, location, attendees (array of emails), timezone
- Batch processing with per-event error tracking
- Returns detailed success/failure counts
- Handles event conflicts gracefully (reports errors without stopping entire batch)

**JSON Format**:
```json
{
  "events": [
    {
      "summary": "Team Meeting",
      "start_time": "2026-02-10T10:00:00-05:00",
      "end_time": "2026-02-10T11:00:00-05:00",
      "description": "Weekly team sync",
      "location": "Conference Room A",
      "attendees": ["team@example.com"],
      "timezone": "America/New_York"
    }
  ]
}
```

**Usage**:
```bash
claude-mpm tools google calendar-bulk-create --file events.json --calendar-id primary
```

### Argument Parser Fix
- Fixed `argparse.REMAINDER` issue that was capturing optional arguments
- Removed `tool_args` to allow proper parsing of all defined arguments
- All calendar-specific arguments now parsed correctly

## Notes
Implementation completed with full calendar export/import functionality. Pagination handles large event sets efficiently. Event conflict handling ensures partial success doesn't block entire batch operations.
