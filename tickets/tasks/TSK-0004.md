---
actual_hours: null
assignees: []
created_at: '2026-02-08T21:17:34.776327'
dependencies: []
description: 'Batch upload, download, permissions, folder operations.


  Acceptance Criteria:

  - [x] claude-mpm tools google drive-batch-upload works

  - [x] claude-mpm tools google drive-batch-download works

  - [x] Progress indicators for large operations'
due_date: null
estimated_hours: null
id: TSK-0004
labels: []
metadata:
  epic: EP-0002
parent: null
priority: high
status: completed
tags:
- ep-0002
- google
- drive
title: Implement Drive bulk operations tools
updated_at: '2026-02-08T03:57:41'
---

# Implement Drive bulk operations tools

## Description
Batch upload, download, permissions, folder operations.

Acceptance Criteria:
- [x] claude-mpm tools google drive-batch-upload works
- [x] claude-mpm tools google drive-batch-download works
- [x] Progress indicators for large operations

## Details
- **Status**: completed
- **Priority**: high
- **Assignees**: None
- **Tags**: ep-0002, google, drive
- **Created**: 2026-02-08 21:17:34
- **Updated**: 2026-02-08 03:57:41
- **Completed**: 2026-02-08 03:57:41

## Implementation

**Commit**: 9bda6fc10

### Drive Batch Upload (drive-batch-upload)
- Upload multiple files to Google Drive in single batch operation
- Comma-separated file paths via `--files` parameter
- Optional parent folder placement via `--parent-id`
- Auto-detects MIME types for common extensions:
  - `.txt`, `.json`, `.html`, `.md`, `.py`, `.js`, `.css`
- MIME type override via `--mime-type` for custom types
- Multipart upload protocol (RFC 2046 compliant)
- Per-file error tracking with detailed error messages
- Text files only (binary detection returns error)
- Returns: file IDs, names, MIME types, webViewLinks

**Usage**:
```bash
# Upload multiple files to root
claude-mpm tools google drive-batch-upload --files "file1.txt,file2.json"

# Upload to specific folder  # pragma: allowlist secret
claude-mpm tools google drive-batch-upload --files "doc1.md,doc2.html" --parent-id "1A2B3C4D5E6F"

# Override MIME type
claude-mpm tools google drive-batch-upload --files "data.csv" --mime-type "text/csv"
```

### Drive Batch Download (drive-batch-download)
- Download multiple files from Google Drive by ID
- Comma-separated file IDs via `--file-ids` parameter
- Optional output directory via `--output-dir` (defaults to current directory)
- Handles Google Workspace files (exports to text/CSV):
  - Google Docs → `.txt`
  - Google Sheets → `.csv`
  - Google Slides → `.txt`
- Supports both text and binary files
- Auto-creates output directory if missing
- Per-file error tracking
- Returns: file paths, names, IDs, and sizes

**Usage**:
```bash
# Download files to current directory
claude-mpm tools google drive-batch-download --file-ids "1A2B,3C4D"

# Download to specific directory
claude-mpm tools google drive-batch-download --file-ids "1A2B,3C4D,5E6F" --output-dir "./downloads"
```

### Helper Methods
- **_make_request_raw()**: Handles raw byte uploads with custom headers
  - Supports multipart/related content type
  - 60-second timeout for large operations
  - Full token validation and error handling

### Progress Indicators
- Metadata includes: `total`, `uploaded_count`/`downloaded_count`, `failed_count`
- Per-file success/failure tracking in data object
- Clear error messages for each failed operation
- JSON output shows complete operation status

## Notes
Implementation completed with full Drive upload/download functionality. Multipart upload matches MCP server patterns. Google Workspace file export handles format conversions automatically. Progress indicators provide detailed operation status for monitoring bulk operations.
