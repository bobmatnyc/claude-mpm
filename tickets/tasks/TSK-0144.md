---
actual_hours: null
assignees: []
created_at: '2025-08-20T13:18:31.884602'
dependencies: []
description: "Test the agent upgrade persistence fix to ensure deployments only run\
  \ once and source information persists correctly.\n\n**Test Requirements**:\n1.\
  \ Run agent deployment command to deploy/upgrade agents\n2. Verify agents deployed\
  \ with correct source information (\"system\" for system agents)  \n3. Run deployment\
  \ command again without --force flag\n4. Verify agents are NOT re-deployed (detected\
  \ as up-to-date)\n5. Check no \"source change\" messages appear on subsequent runs\n\
  6. Confirm fix resolves issue where upgrades happened every startup\n\n**Expected\
  \ Behavior**:\n- First run: Agents deployed/upgraded as needed\n- Second run: System\
  \ detects agents up-to-date, skips deployment\n- No \"Source change: X from unknown\
  \ to system\" messages after initial deployment\n\n**Technical Details**:\n- AgentProcessor\
  \ now properly passes source_info when building agent content\n- Deployed agents\
  \ store \"source: system\" or \"source: user\" in metadata\n- Source information\
  \ should persist across restarts"
due_date: null
estimated_hours: null
id: TSK-0144
labels: []
metadata: {}
parent: null
priority: high
status: open
tags:
- testing
- agent-deployment
- persistence
- fix-verification
title: Test Agent Upgrade Persistence Fix
updated_at: '2025-08-20T13:18:31.884602'
---

# Test Agent Upgrade Persistence Fix

## Description
Test the agent upgrade persistence fix to ensure deployments only run once and source information persists correctly.

**Test Requirements**:
1. Run agent deployment command to deploy/upgrade agents
2. Verify agents deployed with correct source information ("system" for system agents)  
3. Run deployment command again without --force flag
4. Verify agents are NOT re-deployed (detected as up-to-date)
5. Check no "source change" messages appear on subsequent runs
6. Confirm fix resolves issue where upgrades happened every startup

**Expected Behavior**:
- First run: Agents deployed/upgraded as needed
- Second run: System detects agents up-to-date, skips deployment
- No "Source change: X from unknown to system" messages after initial deployment

**Technical Details**:
- AgentProcessor now properly passes source_info when building agent content
- Deployed agents store "source: system" or "source: user" in metadata
- Source information should persist across restarts

## Details
- **Status**: open
- **Priority**: high
- **Assignees**: None
- **Tags**: testing, agent-deployment, persistence, fix-verification
- **Created**: 2025-08-20 13:18:31
- **Updated**: 2025-08-20 13:18:31

## Tasks
- [ ] Add task items here

## Notes
_Add any additional notes or context here._
